C Language
==========

Overview
--------

- Developed in 1972 to create Unix utilities
- Unix kernel was re-implemented in C
- Most current operating system kernels are written in C (Linux, BSD, Windows, MacOS, iOS)

Features
--------

- General purpose
- Procedural
- Statically typed
- Standardized language with many implementations

Why C?
------

- Low-level, portable language

Low-level
---------

- Allows direct access to memory
- Allows assembly to be embedded

Portable
--------

- Assembly targets a specific ISA
- C can be compiled for different architectures
- OS kernels can be run on x86 and ARM without modification

Simplicity
----------

- C has a relatively small number of primitives
- Compilers can be [small](https://bellard.org/otcc/)

Scope
-----

- Provides lexical scope to eliminate global variables
- Functions exist in global namespace
- Functions may not be declared within other functions

Typing
------

- Variable are statically typed
- Type rules are weakly enforced
- Implicit conversions are possible

---

```c
int a = 1;
float b = 2.0;

printf("%f\n", a + b); // Prints 3.0
```

---

```c
char * a = 1;
int b = 2;

printf("%d\n", a + b); // Prints 3
```

Common types
------------

- `int`, `char`, `float`
- `unsigned int`, `long int`
- Pointers - `int*`, `char*`

Other Types
-----------

- Arrays - `[1, 2, 3]` (essentially just pointers)
- `struct`
- `enum`

Batteries not Included
----------------------

- Most "complex" features are delegated to libraries
- The core language doesn't support common types such as strings
- The standard library (written in C) is part of the standard and many implementations are available

Standard Library
----------------

- [libc](https://en.wikipedia.org/wiki/C_standard_library)
- Many implementations available (BSD libc, glibc, MSVCRT.DLL, etc)
- Defines interfaces for strings, math, I/O, OS operations, and more

Hello World
-----------

```
#include <stdio.h>

int main() {
  printf("Hello, world!\n");
}
```

unistd.h
--------

- Not part of the C standard library
- Provides access to POSIX operating system API
- [More info](https://en.wikipedia.org/wiki/Unistd.h)

Hello World
-----------

```
#include <unistd.h>

int main() {
  write(1, "Hello, world!\n", 14);
}
```

Format Strings
--------------

- Allow values of various types to be interpolated into strings
- Used by `printf`, `fprintf`, `scanf`, and others

---

```
#include <stdio.h>

int main() {
  int a = 1;
  char b = 'a';
  float c = 2.0;

  printf("%d %c %f\n", a, b, c);
}
```

Functions
---------

```
#include <stdio.h>

int add(int a, int b) {
  return a + b;
}

int main() {
  printf("%d", add(1,2));
}
```

Pointers
--------

- Provide references to memory
- Just an unsigned integer of the appropriate size
- `int *a` defines pointer `a`
- `*b` dereferences `b`
- `&c` returns the address of `c` 

---

```
#include <stdio.h>

int increment(int* value) {
  *value += 1;
}

int main() {
  int a = 1;
  increment(&a);

  printf("%d", a);
}
```

Running C Programs
------------------

- Compile to executable: `gcc source.c --output executable`
- Run the executable: `./executable`
- `tcc` can run C compile and run in one step: `tcc -run source.c`
